{% extends 'todotodo/base.html' %}
{% load static %}
{% load sass_tags %}
{% block style %}
<link
rel="stylesheet"
type="text/css"
href="{% sass_src 'todotodo/scss/home.css' %}"
/>
{% endblock style %}
{% block js %}
<script src="{% static 'todotodo/js/home.js' %}"></script>
{% endblock js %}
{% block content %}
    <body>
        <header>
            <title>home</title>
            {% comment %} 내 메인페이지와 친구 페이지 따로 만들어둠  {% endcomment %}
            <div class="header-my">             
            </div>
            {% comment %} 여기까지 {% endcomment %}
        </header>
        <main class="body-container" id="main-container">
            <div class="main-view-container">
                <div class="container-top">
                    <svg id="historyicon" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21.7115 20.5233L27.2896 26.0571C27.4372 26.2047 27.511 26.3744 27.511 26.5663C27.511 26.7581 27.4372 26.9278 27.2896 27.0754C27.142 27.2229 26.9797 27.2967 26.8026 27.2967C26.6255 27.2967 26.4632 27.2229 26.3156 27.0754L20.6932 21.4972C20.5752 21.3497 20.4866 21.2021 20.4276 21.0545C20.3686 20.907 20.3391 20.7594 20.3391 20.6118V12.5988C20.3391 12.3922 20.4055 12.2299 20.5383 12.1118C20.6711 11.9938 20.8261 11.9347 21.0031 11.9347C21.2097 11.9347 21.3794 11.9938 21.5123 12.1118C21.6451 12.2299 21.7115 12.3922 21.7115 12.5988V20.5233ZM20.6932 34.9999C17.0925 34.9999 14.001 33.8562 11.4185 31.5689C8.83603 29.2815 7.29392 26.3818 6.79219 22.8696C6.76267 22.663 6.79957 22.486 6.90286 22.3384C7.00616 22.1908 7.16111 22.1023 7.36771 22.0728C7.54479 22.0433 7.69974 22.0875 7.83255 22.2056C7.96536 22.3236 8.04653 22.4712 8.07604 22.6483C8.63681 25.8063 10.0756 28.4256 12.3925 30.5064C14.7093 32.5871 17.4762 33.6275 20.6932 33.6275C24.2939 33.6275 27.3412 32.3731 29.8352 29.8644C32.3291 27.3558 33.5761 24.3011 33.5761 20.7004C33.5761 17.1587 32.3217 14.163 29.813 11.7134C27.3044 9.26373 24.2644 8.0389 20.6932 8.0389C18.8929 8.0389 17.1811 8.4152 15.5578 9.16781C13.9346 9.92041 12.5031 10.946 11.2635 12.2446H14.8495C15.0561 12.2446 15.2184 12.311 15.3365 12.4439C15.4545 12.5767 15.5135 12.7316 15.5135 12.9087C15.5135 13.1153 15.4545 13.285 15.3365 13.4178C15.2184 13.5506 15.0561 13.617 14.8495 13.617H10.0682C9.71406 13.617 9.41893 13.499 9.18281 13.2629C8.9467 13.0268 8.82865 12.7316 8.82865 12.3774V7.55192C8.82865 7.37484 8.89505 7.21989 9.02787 7.08708C9.16068 6.95426 9.31563 6.88786 9.49271 6.88786C9.69931 6.88786 9.86901 6.95426 10.0018 7.08708C10.1346 7.21989 10.201 7.37484 10.201 7.55192V11.3592C11.5587 9.91303 13.1451 8.76937 14.9602 7.92822C16.7753 7.08708 18.6863 6.6665 20.6932 6.6665C22.6707 6.6665 24.5153 7.03543 26.2271 7.77328C27.9389 8.51112 29.4441 9.52198 30.7427 10.8058C32.0413 12.0897 33.0596 13.5875 33.7974 15.2993C34.5353 17.0111 34.9042 18.841 34.9042 20.7889C34.9042 22.7368 34.5353 24.5815 33.7974 26.3228C33.0596 28.0641 32.0413 29.5693 30.7427 30.8384C29.4441 32.1075 27.9389 33.1183 26.2271 33.871C24.5153 34.6236 22.6707 34.9999 20.6932 34.9999Z" fill="#282828"/>
                    </svg>
                    <svg id="alerticon" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8.125 31.2085C7.95833 31.2085 7.8125 31.146 7.6875 31.021C7.5625 30.896 7.5 30.7502 7.5 30.5835C7.5 30.3891 7.5625 30.2293 7.6875 30.1043C7.8125 29.9793 7.95833 29.9168 8.125 29.9168H10.9167V16.9168C10.9167 14.8057 11.6042 12.8752 12.9792 11.1252C14.3542 9.37516 16.1667 8.30572 18.4167 7.91683V6.7085C18.4167 6.26405 18.5625 5.90294 18.8542 5.62516C19.1458 5.34738 19.5278 5.2085 20 5.2085C20.4722 5.2085 20.8542 5.34738 21.1458 5.62516C21.4375 5.90294 21.5833 6.26405 21.5833 6.7085V7.91683C23.8333 8.30572 25.6528 9.37516 27.0417 11.1252C28.4306 12.8752 29.125 14.8057 29.125 16.9168V29.9168H31.875C32.0417 29.9168 32.1875 29.9793 32.3125 30.1043C32.4375 30.2293 32.5 30.3891 32.5 30.5835C32.5 30.7779 32.4375 30.9307 32.3125 31.0418C32.1875 31.1529 32.0417 31.2085 31.875 31.2085H8.125ZM20 36.0418C19.2778 36.0418 18.6458 35.7849 18.1042 35.271C17.5625 34.7571 17.2917 34.1113 17.2917 33.3335H22.7083C22.7083 34.1113 22.4514 34.7571 21.9375 35.271C21.4236 35.7849 20.7778 36.0418 20 36.0418ZM12.1667 29.9168H27.8333V16.9168C27.8333 14.7502 27.0764 12.9029 25.5625 11.3752C24.0486 9.84738 22.2083 9.0835 20.0417 9.0835C17.8472 9.0835 15.9861 9.84738 14.4583 11.3752C12.9306 12.9029 12.1667 14.7502 12.1667 16.9168V29.9168Z" fill="#333333"/>
                    </svg>
                </div>
                <div class="main-content">
                    <div class="persona-container">
                        <div class="persona-list" id="persona-list">
                            <div class="each-persona">
                                <div class="persona-list">
                                    {% for persona in personas %}
                                    <a href="/todo/home?persona_id={{persona.id}}">
                                            <img class = "persona-image" src="{{ persona.emoji }}"/>
                                    </a>
                                    {% endfor %}
                                </div>
                            </div>
                            <button id='persona-create-button' onclick="showAddPersonaModal()"> + </button>
                        </div>
                    </div>

                    <div class="profile-container">
                        <div class="profile-photo">
                            <img id="profile-img" src="{{ persona.emoji }}"/>
                        </div>
                        <div class="profile-description">
                            <div class="persona-name">
                                <span class="persona-name-text">{{ persona.name }}&nbsp;</span>
                                <span class="username">{{ user.get_username }}</span>
                                <span class="user-name-text">님</span>
                            </div>
                            <div class="header-friend">
                            </div>
                        </div>
                    </div>

                    <div class="calendar-container" id="calendar-container">
                        <div class="calendar-selection">
                            <div id="current-month">
                                <script>
                                    date = new Date();
                                    year = date.getFullYear();
                                    month = date.getMonth() + 1;  
                                    document.getElementById("current-month").innerHTML=`${month}월`;
                                </script>
                            </div>
                            <div id="weeklymonthly">
                                <div onclick="showWeekDate({{persona.id}})" class="weekly bold" id="weekly-text">weekly</div>
                                <div onclick="showMonthDate({{persona.id}})" class="monthly" id="monthly-text">monthly</div>
                            </div>
                            <svg id="leftarrow" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8.33329 18.0418L0.291626 10.0002L8.33329 1.9585L9.29163 2.91683L2.20829 10.0002L9.29163 17.0835L8.33329 18.0418Z" fill="#282828"/>
                            </svg>
                            <svg id="rightarrow" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M11.6667 18.0418L19.7084 10.0002L11.6667 1.9585L10.7084 2.91683L17.7917 10.0002L10.7084 17.0835L11.6667 18.0418Z" fill="#282828"/>
                            </svg>
                        </div>
                        <div class="day-of-weeks">
                            <div class="day-of-week">S</div>
                            <div class="day-of-week">M</div>
                            <div class="day-of-week">T</div>
                            <div class="day-of-week">W</div>
                            <div class="day-of-week">T</div>
                            <div class="day-of-week">F</div>
                            <div class="day-of-week">S</div>
                        </div>
                        {% comment %} {% if %} {% endcomment %}
                        <div class="calendar-date" id="calendar-date">
                            <div class="week-date" id="week-week-date">
                                {% for date in weekcal %}
                                {% if date == 0 %}
                                <div class="date-int">
                                <span>&nbsp</span>
                                </div>
                                {% endif %}
                                {% if date != 0 %}
                                {% if date == todaydate %}
                                <div class="date-int" id="{{todaydate}}-date">
                                    <div class="today"> 
                                        {{date}} 
                                    </div>                        
                                </div>
                                {% endif %}
                                {% if date != todaydate %}
                                <div class="date-int" id="{{date}}-date">
                                    <span > {{date}} </span>
                                </div>
                                {% endif %}
                                {% endif %}
                                {% endfor %}
                            </div>                
                            {% comment %} {% endif %} {% endcomment %}
                            {% comment %} {% if %} {% endcomment %}
                            <div class="month-date hide" id="month-date">
                                {% for week in monthcal %}
                                <div class="week-date" id="month-week-date">
                                    {% for date in week %}
                                    {% if date == 0 %}
                                    <div class="date-int">
                                        <span>&nbsp</span>
                                    </div>
                                    {% endif %}
                                    {% if date != 0 %}
                                    {% if date == todaydate %}
                                    <div class="date-int">
                                        <div class="today"> 
                                            {{date}} 
                                        </div>
                                    </div>                        
                                    {% endif %}
                                    {% if date != todaydate %}
                                    <div class="date-int">
                                        <span > {{date}} </span>
                                    </div>
                                    {% endif %}
                                    {% endif %}
                                    {%endfor%}
                                </div>
                                {%endfor%}
                            </div>
                        {% comment %} </div> {% endcomment %}
                        </div>
                    </div>
                    {% comment %} {% if todoreqeusts %} {% endcomment %}
                    <div class="waiting-list-container">
                        <div id="waiting-text">📩 대기 중!</div>
                        <div class="waiting-todo-container">
                            <img src=""/>
                            {% for todorequest in todorequests %}
                            <div class="waiting-todo-content" id="{{todorequest.id}}-content">
                                <input type="checkbox" class="request-checkbox" /> 
                                <div class="todorequest-text-container">
                                    <div class="requesttodo-name">{{ todorequest.todo_name }}</div>
                                    <div class="reqeusttodo-deadline">{{ todorequest.sender }} • 기한까지{{ todorequest.todo_end_date }}일</div>
                                </div>
                                <svg class="requesttodo-detail" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.2 13.1998C4.86667 13.1998 4.58333 13.0831 4.35 12.8498C4.11667 12.6165 4 12.3331 4 11.9998C4 11.6665 4.11667 11.3831 4.35 11.1498C4.58333 10.9165 4.86667 10.7998 5.2 10.7998C5.53333 10.7998 5.81667 10.9165 6.05 11.1498C6.28333 11.3831 6.4 11.6665 6.4 11.9998C6.4 12.3331 6.28333 12.6165 6.05 12.8498C5.81667 13.0831 5.53333 13.1998 5.2 13.1998ZM12 13.1998C11.6667 13.1998 11.3833 13.0831 11.15 12.8498C10.9167 12.6165 10.8 12.3331 10.8 11.9998C10.8 11.6665 10.9167 11.3831 11.15 11.1498C11.3833 10.9165 11.6667 10.7998 12 10.7998C12.3333 10.7998 12.6167 10.9165 12.85 11.1498C13.0833 11.3831 13.2 11.6665 13.2 11.9998C13.2 12.3331 13.0833 12.6165 12.85 12.8498C12.6167 13.0831 12.3333 13.1998 12 13.1998ZM18.8 13.1998C18.4667 13.1998 18.1833 13.0831 17.95 12.8498C17.7167 12.6165 17.6 12.3331 17.6 11.9998C17.6 11.6665 17.7167 11.3831 17.95 11.1498C18.1833 10.9165 18.4667 10.7998 18.8 10.7998C19.1333 10.7998 19.4167 10.9165 19.65 11.1498C19.8833 11.3831 20 11.6665 20 11.9998C20 12.3331 19.8833 12.6165 19.65 12.8498C19.4167 13.0831 19.1333 13.1998 18.8 13.1998Z" fill="#919191"/>
                                </svg>

                            </div>
                            {%endfor%}
                        </div>
                    </div> 
                    {% comment %} {% endif %} {% endcomment %}
                    <div class="category-container">
                        {% for category in categories %}
                        <div class="category-name">
                            <span class="category-name-container">{{ category.name }}</span>
                            <div class="todo-create-button" onclick="showTodoInput('{{category.name}}', '{{category.id}}', '{{persona.id}}')">
                                <svg  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="40" height="40" rx="10" fill="#F5F5F5"/>
                                    <g clip-path="url(#clip0_98_918)">
                                    <path d="M19.8671 28.4456V21.2136H12.6351V19.8667H19.8671V12.6348H21.214V19.8667H28.4459V21.2136H21.214V28.4456H19.8671Z" fill="#515151"/>
                                    </g>
                                    <defs>
                                    <clipPath id="clip0_98_918">
                                    <rect width="28.1081" height="28.1081" fill="white" transform="translate(6.48651 6.48633)"/>
                                    </clipPath>
                                    </defs>
                                </svg>     
                            </div>                       
                        </div>
                        <div id="{{category.name}}-todo-list">
                            <div class="todo-input-container " id="{{category.name}}-input-container">
                            </div>
                            {% for key, value in todos %}
                            {% if key == category.name %}
                            {% for todo in value %}
                            {% comment %} {% if todo.start_date == todaydate %} {% endcomment %}
                            {% if todo.completed == False %}
                            <div class="todo-container" id="todo-container-{{todo.id}}">
                                <input class="todo-checkbox" onclick="completeTodo('{{todo.name}}','{{todo.id}}')" type="checkbox"/>
                                <div class="todoname-text" id="{{todo.name}}-todoname" onclick="editTodo('{{todo.id}}', '{{todo.name}}')">{{ todo.name }}</div>
                                <svg class="todo-detail" onclick="showTodoDeleteModal('{{todo.name}}')" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.2 13.1998C4.86667 13.1998 4.58333 13.0831 4.35 12.8498C4.11667 12.6165 4 12.3331 4 11.9998C4 11.6665 4.11667 11.3831 4.35 11.1498C4.58333 10.9165 4.86667 10.7998 5.2 10.7998C5.53333 10.7998 5.81667 10.9165 6.05 11.1498C6.28333 11.3831 6.4 11.6665 6.4 11.9998C6.4 12.3331 6.28333 12.6165 6.05 12.8498C5.81667 13.0831 5.53333 13.1998 5.2 13.1998ZM12 13.1998C11.6667 13.1998 11.3833 13.0831 11.15 12.8498C10.9167 12.6165 10.8 12.3331 10.8 11.9998C10.8 11.6665 10.9167 11.3831 11.15 11.1498C11.3833 10.9165 11.6667 10.7998 12 10.7998C12.3333 10.7998 12.6167 10.9165 12.85 11.1498C13.0833 11.3831 13.2 11.6665 13.2 11.9998C13.2 12.3331 13.0833 12.6165 12.85 12.8498C12.6167 13.0831 12.3333 13.1998 12 13.1998ZM18.8 13.1998C18.4667 13.1998 18.1833 13.0831 17.95 12.8498C17.7167 12.6165 17.6 12.3331 17.6 11.9998C17.6 11.6665 17.7167 11.3831 17.95 11.1498C18.1833 10.9165 18.4667 10.7998 18.8 10.7998C19.1333 10.7998 19.4167 10.9165 19.65 11.1498C19.8833 11.3831 20 11.6665 20 11.9998C20 12.3331 19.8833 12.6165 19.65 12.8498C19.4167 13.0831 19.1333 13.1998 18.8 13.1998Z" fill="#919191"/>
                                </svg>
                                <div class="entiretodomodal hide" id="{{todo.name}}-delete-entire">
                                <div class="tododeleteModal" id="{{todo.name}}-delete-modal">
                                    <div class="delete-category-name-container">{{ category.name }}</div>
                                    <div class="delete-todo-name-container">{{todo.name}}</div>
                                    <button class="delete-todo-button" onclick="deleteTodo('{{todo.name}}','{{todo.id}}')">❌ 삭제하기</button>
                                </div>
                                <div class="todomodalbackground"></div>
                                </div>
                            </div>
                            {% endif %}
                            {% if todo.completed == True %}
                            <div class="todo-container" id="{{todo.name}}-container">
                                <div class = "todo-individual">
                                    <input class="todo-checkbox complete" onclick="completeTodo('{{todo.name}}','{{todo.id}}')" type="checkbox" checked/>
                                    <div class="todoname-text complete" id="{{todo.name}}-todoname">{{ todo.name }}</div>
                                <svg class="todo-detail" onclick="showTodoDeleteModal('{{todo.name}}')" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.2 13.1998C4.86667 13.1998 4.58333 13.0831 4.35 12.8498C4.11667 12.6165 4 12.3331 4 11.9998C4 11.6665 4.11667 11.3831 4.35 11.1498C4.58333 10.9165 4.86667 10.7998 5.2 10.7998C5.53333 10.7998 5.81667 10.9165 6.05 11.1498C6.28333 11.3831 6.4 11.6665 6.4 11.9998C6.4 12.3331 6.28333 12.6165 6.05 12.8498C5.81667 13.0831 5.53333 13.1998 5.2 13.1998ZM12 13.1998C11.6667 13.1998 11.3833 13.0831 11.15 12.8498C10.9167 12.6165 10.8 12.3331 10.8 11.9998C10.8 11.6665 10.9167 11.3831 11.15 11.1498C11.3833 10.9165 11.6667 10.7998 12 10.7998C12.3333 10.7998 12.6167 10.9165 12.85 11.1498C13.0833 11.3831 13.2 11.6665 13.2 11.9998C13.2 12.3331 13.0833 12.6165 12.85 12.8498C12.6167 13.0831 12.3333 13.1998 12 13.1998ZM18.8 13.1998C18.4667 13.1998 18.1833 13.0831 17.95 12.8498C17.7167 12.6165 17.6 12.3331 17.6 11.9998C17.6 11.6665 17.7167 11.3831 17.95 11.1498C18.1833 10.9165 18.4667 10.7998 18.8 10.7998C19.1333 10.7998 19.4167 10.9165 19.65 11.1498C19.8833 11.3831 20 11.6665 20 11.9998C20 12.3331 19.8833 12.6165 19.65 12.8498C19.4167 13.0831 19.1333 13.1998 18.8 13.1998Z" fill="#919191"/>
                                </svg>
                                </div>
                            </div>
                            {% endif %}
                            {% comment %} {%endif%} {% endcomment %}
                            {%endfor%}
                            {%endif%}
                            {%endfor%}
                        </div>
                        {% endfor %}

                            {% comment %} 여기까지 {% endcomment %}
                    </div>
                </div>
                <div class="bottom-navigation-bar">
                    <a>
                        <img class="bottom-navigator" src="{% static 'todotodo/img/home_icon.svg' %}" />
                    </a>
                    <a href="/todo/mypage/">
                        <img class="bottom-navigator" src="{% static 'todotodo/img/mypage_icon.svg' %}" />
                    </a>
                </div>
            </div>
            <div class="mypage-modal hide" id="add-persona-modal">
                <div class="background-space" onclick="hideAddPersonaModal()"></div>
                <div id="inner-add-persona-modal">
                    <div class="modal-top">
                        <span>새 페르소나</span>
                        <div class="modal-complete" onclick="completeAddPersonaModal()">
                            <object type="image/svg+xml" data="{% static 'mypage/img/complete_check.svg'%}"></object>
                            <span>완료</span>
                        </div>
                    </div>
                    <div id="new-persona-imoji-div">
                        <img id="new-persona-imoji"/>
                    </div>
                    <div id="new-persona-name">
                        <span>새로운 페르소나에 이름을 붙여주세요.</span>
                        <div class="name-input-field">
                            <input id="new-persona-name-input" class="name-input" type="text" placeholder="ex. 열심히 일하는" oninput="handleResetAndCompleteButton(this)" />
                            <img class="name-input-reset-button hide" src="{% static 'mypage/img/reset_input_x.svg' %}" onclick="resetInput(this)" />
                            <span>{{user.get_username}}님</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </body>
{% endblock content %}